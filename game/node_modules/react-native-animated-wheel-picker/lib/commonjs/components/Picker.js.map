{"version":3,"names":["Picker","itemHeight","pickerData","visible","textStyle","maskedComponents","contentContainerStyle","initialIndex","onSelected","props","styles","container","duration","PickerItem","translateY","useSharedValue","snapPoints","Array","length","fill","map","_","i","timingConfig","easing","Easing","bezier","wrapper","index","onGestureEvent","useAnimatedGestureHandler","onStart","_event","ctx","y","value","onActive","translationY","onEnd","velocityY","snapPointY","snapPoint","Math","abs","withTiming","runOnJS","animatedStyle","useAnimatedStyle","transform","height","paddingTop","item","trunc","backgroundColor","StyleSheet","absoluteFillObject","flex","Item","data","useDerivedValue","interpolate","Extrapolate","CLAMP","textAnimation","opacity","scale","perspective","rotateX","textContainer","title","create","overflow","justifyContent","alignItems"],"sources":["Picker.tsx"],"sourcesContent":["import {\n  View,\n  StyleSheet,\n  ViewProps,\n  StyleProp,\n  TextStyle,\n  ViewStyle,\n} from 'react-native';\nimport React from 'react';\nimport Animated, {\n  Easing,\n  Extrapolate,\n  interpolate,\n  runOnJS,\n  useAnimatedGestureHandler,\n  useAnimatedStyle,\n  useDerivedValue,\n  useSharedValue,\n  withTiming,\n} from 'react-native-reanimated';\nimport {\n  PanGestureHandlerGestureEvent,\n  PanGestureHandler,\n  GestureHandlerRootView,\n} from 'react-native-gesture-handler';\nimport { snapPoint } from 'react-native-redash';\nimport MaskedView from '@react-native-masked-view/masked-view';\n\nexport type PickerData = {\n  title: string;\n  value: any;\n};\nexport type PickerProps = ViewProps & {\n  itemHeight?: number;\n  pickerData: PickerData[];\n  initialIndex?: number;\n  visible?: number;\n  textStyle?: StyleProp<TextStyle>;\n  maskedComponents?: JSX.Element | JSX.Element[];\n  contentContainerStyle?: StyleProp<ViewStyle>;\n  onSelected: (data: PickerData, index: number) => void;\n};\nconst Picker = ({\n  itemHeight = 30,\n  pickerData,\n  visible = 5,\n  textStyle,\n  maskedComponents,\n  contentContainerStyle,\n  initialIndex = 0,\n  onSelected,\n  ...props\n}: PickerProps) => {\n  return (\n    <View {...props} style={[styles.container]}>\n      <PickerItem\n        itemHeight={itemHeight}\n        pickerData={pickerData}\n        visible={visible}\n        textStyle={textStyle ?? {}}\n        maskedComponents={maskedComponents}\n        contentContainerStyle={contentContainerStyle}\n        initialIndex={initialIndex}\n        onSelected={onSelected}\n      />\n    </View>\n  );\n};\n\ntype PickerItemProps = Required<\n  Pick<\n    PickerProps,\n    'itemHeight' | 'pickerData' | 'visible' | 'textStyle' | 'initialIndex'\n  >\n> &\n  Pick<\n    PickerProps,\n    'maskedComponents' | 'onSelected' | 'contentContainerStyle'\n  >;\n\nconst duration = 1000;\nconst PickerItem = ({\n  itemHeight,\n  pickerData,\n  visible,\n  textStyle,\n  maskedComponents,\n  contentContainerStyle,\n  initialIndex,\n  onSelected,\n}: PickerItemProps) => {\n  const translateY = useSharedValue(-itemHeight * initialIndex);\n  const snapPoints = new Array(pickerData.length)\n    .fill(0)\n    .map((_, i) => i * -itemHeight);\n\n  const timingConfig = {\n    duration: duration,\n    easing: Easing.bezier(0.35, 1, 0.35, 1),\n  };\n\n  const wrapper = (index: number) => {\n    onSelected && onSelected(pickerData[index], index);\n  };\n\n  const onGestureEvent =\n    useAnimatedGestureHandler<PanGestureHandlerGestureEvent>({\n      onStart: (_event, ctx) => {\n        // @ts-ignore\n        ctx.y = translateY.value;\n        // triggered at the start of the pan gesture\n      },\n      onActive: ({ translationY }, ctx) => {\n        // @ts-ignore\n        translateY.value = translationY + ctx.y;\n        // triggered on every frame of the pan gesture\n      },\n      onEnd: ({ velocityY }) => {\n        const snapPointY = snapPoint(translateY.value, velocityY, snapPoints);\n        const index = Math.abs(snapPointY / itemHeight);\n        translateY.value = withTiming(snapPointY, timingConfig);\n        runOnJS(wrapper)(index);\n        // triggered at the end of the pan gesture\n      },\n    });\n  const animatedStyle = useAnimatedStyle(() => ({\n    transform: [{ translateY: translateY.value }],\n  }));\n\n  return (\n    <>\n      <MaskedView\n        androidRenderingMode=\"software\"\n        maskElement={\n          <View>\n            <Animated.View\n              style={[\n                animatedStyle,\n                contentContainerStyle,\n                {\n                  height: itemHeight * visible,\n                  paddingTop: (itemHeight * visible) / 2 - itemHeight / 2,\n                },\n              ]}\n            >\n              {pickerData.map((item, index) => (\n                <Item\n                  key={index}\n                  translateY={translateY}\n                  index={index}\n                  itemHeight={itemHeight}\n                  visible={visible}\n                  data={item}\n                  textStyle={textStyle}\n                />\n              ))}\n            </Animated.View>\n          </View>\n        }\n      >\n        {maskedComponents ? (\n          maskedComponents\n        ) : (\n          <>\n            <View\n              // eslint-disable-next-line react-native/no-inline-styles\n              style={{\n                height: itemHeight * Math.trunc(visible / 2),\n                backgroundColor: 'grey',\n              }}\n            />\n\n            <View\n              // eslint-disable-next-line react-native/no-inline-styles\n              style={{ height: itemHeight, backgroundColor: 'white' }}\n            />\n            <View\n              // eslint-disable-next-line react-native/no-inline-styles\n              style={{\n                height: itemHeight * Math.trunc(visible / 2),\n                backgroundColor: 'grey',\n              }}\n            />\n          </>\n        )}\n      </MaskedView>\n      <GestureHandlerRootView style={StyleSheet.absoluteFillObject}>\n        <PanGestureHandler onGestureEvent={onGestureEvent}>\n          <Animated.View\n            // eslint-disable-next-line react-native/no-inline-styles\n            style={{\n              flex: 1,\n            }}\n          />\n        </PanGestureHandler>\n      </GestureHandlerRootView>\n    </>\n  );\n};\n\ntype ItemProps = {\n  translateY: Animated.SharedValue<number>;\n  index: number;\n  data: PickerData;\n} & Required<Pick<PickerProps, 'itemHeight' | 'visible'>> &\n  Pick<PickerProps, 'textStyle'>;\nconst Item = ({\n  translateY,\n  index,\n  itemHeight,\n  visible,\n  data,\n  textStyle,\n}: ItemProps) => {\n  // const y = useDerivedValue(() => translateY.value, [translateY.value]);\n\n  const y = useDerivedValue(() =>\n    interpolate(\n      translateY.value / -itemHeight,\n      [index - visible / 2, index, index + visible / 2],\n      [-1, 0, 1],\n      Extrapolate.CLAMP\n    )\n  );\n\n  const textAnimation = useAnimatedStyle(() => {\n    return {\n      opacity: 1 / (1 + Math.abs(y.value)),\n      transform: [\n        {\n          scale: 1 - 0.1 * Math.abs(y.value),\n        },\n        {\n          perspective: 500,\n        },\n        {\n          rotateX: `${65 * y.value}deg`,\n        },\n      ],\n    };\n  });\n  return (\n    <View style={[styles.textContainer, { height: itemHeight }]}>\n      <Animated.Text style={[textAnimation, textStyle]}>\n        {data.title}\n      </Animated.Text>\n    </View>\n  );\n};\n\nexport default Picker;\n\nconst styles = StyleSheet.create({\n  container: {\n    overflow: 'hidden',\n    justifyContent: 'center',\n    flex: 1,\n  },\n  textContainer: {\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n});\n"],"mappings":"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"}